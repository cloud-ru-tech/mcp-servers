# üê≥ Docker Guide –¥–ª—è MCP Artifact Registry Server

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –∑–∞–ø—É—Å—Ç–∏—Ç—å MCP Artifact Registry Server —Å –ø–æ–º–æ—â—å—é Docker.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker 20.10+
- Docker Compose 2.0+
- –ö–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞ Cloud.ru

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
export CLOUD_RU_KEY_ID="your_key_id_here"
export CLOUD_RU_SECRET="your_secret_here"  
export CLOUD_RU_PROJECT_ID="your_project_id_here"
```

### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
make compose-up

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
docker-compose up -d
```

### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
make docker-build

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
make docker-run
```

## üõ†Ô∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Make

### Docker –∫–æ–º–∞–Ω–¥—ã
```bash
make docker-build        # –°–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑
make docker-run          # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ Docker
make docker-run-build    # –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
make docker-stop         # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
make docker-clean        # –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã
make docker-logs         # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
```

### Docker Compose –∫–æ–º–∞–Ω–¥—ã
```bash
make compose-up          # –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ docker-compose
make compose-down        # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å docker-compose
make compose-build       # –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
make compose-logs        # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
make compose-restart     # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
make compose-ps          # –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```

### –£—Ç–∏–ª–∏—Ç—ã
```bash
make health              # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞
make status              # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make env-check           # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
make env-example         # –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è |
|------------|----------|--------------|
| `CLOUD_RU_KEY_ID` | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª—é—á–∞ –¥–æ—Å—Ç—É–ø–∞ | ‚úÖ |
| `CLOUD_RU_SECRET` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ | ‚úÖ |
| `CLOUD_RU_PROJECT_ID` | UUID –ø—Ä–æ–µ–∫—Ç–∞ –≤ Cloud.ru | ‚úÖ |

### –§–∞–π–ª .env (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# Cloud.ru API –∫–ª—é—á–∏
CLOUD_RU_KEY_ID=your_key_id_here
CLOUD_RU_SECRET=your_secret_here
CLOUD_RU_PROJECT_ID=your_project_id_here
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ß–µ—Ä–µ–∑ Make
make health

# –ù–∞–ø—Ä—è–º—É—é
curl -I http://localhost:8004/sse
```

### –õ–æ–≥–∏

```bash
# Docker Compose
make compose-logs

# Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
make docker-logs

# –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
docker-compose logs -f mcp-artifact-registry
```

### –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
make compose-ps
# –∏–ª–∏
docker-compose ps
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Docker

### –°–µ—Ä–≤–∏—Å—ã

1. **mcp-artifact-registry** - –æ—Å–Ω–æ–≤–Ω–æ–π MCP —Å–µ—Ä–≤–µ—Ä
   - –ü–æ—Ä—Ç: 8004
   - Healthcheck: `/sse` endpoint
   - Volume: `./logs:/app/logs`

2. **healthcheck-monitor** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
   - –í—ã–≤–æ–¥–∏—Ç –ª–æ–≥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –°–µ—Ç—å

- **mcp-network** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–µ—Ç—å –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
- –¢–∏–ø: bridge
- –ò–º—è: `mcp-artifact-registry-network`

### Volumes

- **logs** - –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (`./logs:/app/logs`)

## üîç Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
make env-check

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
make docker-logs
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
make status

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–¥–æ—Ä–æ–≤—å–µ
make health

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã
docker-compose ps
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –≤ Cloud.ru
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ project_id —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### Horizontal scaling

```bash
# –ó–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤
docker-compose up -d --scale mcp-artifact-registry=3
```

### Load Balancer

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –¥–æ–±–∞–≤—å—Ç–µ nginx –∏–ª–∏ traefik:

```yaml
services:
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    depends_on:
      - mcp-artifact-registry
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
```

## üö® –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –≤ git
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker secrets –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- –†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞

### –°–µ—Ç—å

- –°–µ—Ä–≤–∏—Å—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–µ—Ç–∏
- –ü–æ—Ä—Ç 8004 –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ localhost
- –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ reverse proxy

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Cloud.ru](https://cloud.ru/docs/artifact-registry-evolution/)
- [Docker Compose Reference](https://docs.docker.com/compose/)
- [MCP Protocol](https://modelcontextprotocol.io/)

---

üí° **–°–æ–≤–µ—Ç**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `make help` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥! 